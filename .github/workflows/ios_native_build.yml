name: iOS Native Build

on:
  push:
    branches:
      - main  # 当推送到 'main' 分支时触发工作流

jobs:
  build-ios:
    runs-on: macos-latest

    steps:
    # 检出代码
    - name: Checkout repository
      uses: actions/checkout@v4

    # 清除 Xcode 缓存
    - name: Clean Xcode Cache
      run: |
        rm -rf ~/Library/Developer/Xcode/DerivedData
        rm -rf ~/Library/Developer/Xcode/iOS\ DeviceSupport
        rm -rf ~/Library/Developer/Xcode/Archives
        rm -rf ~/Library/Developer/Xcode/Products
    
    # 选择 Xcode 版本
    - name: Select Xcode 16.2
      run: sudo xcode-select -s /Applications/Xcode_16.2.app
      
    # 设置 CocoaPods
    - name: Setup CocoaPods
      run: |
        echo "开始安装 CocoaPods 依赖..."
        pod install

    # 打印环境信息
    - name: Print Environment Info
      run: |
        echo "============= Environment Variables ============="
        echo "Current Directory: $(pwd)"
        echo "Xcode Version:"
        xcodebuild -version
        echo "============= 查找项目文件 ============="
        ls -la *.xcworkspace 2>/dev/null || echo "未找到 .xcworkspace 文件"
        ls -la *.xcodeproj 2>/dev/null || echo "未找到 .xcodeproj 文件"
        echo "============= Available Schemes ============="
        WORKSPACE_FILE=$(find . -name "*.xcworkspace" -maxdepth 1 | head -n 1)
        if [ -n "$WORKSPACE_FILE" ]; then
          echo "使用 workspace: $WORKSPACE_FILE"
          xcodebuild -workspace "$WORKSPACE_FILE" -list
        else
          echo "错误：未找到 .xcworkspace 文件"
          exit 1
        fi
 
    # 安装证书步骤
    - name: Install Certificate
      env:
        BUILD_CERTIFICATE_BASE64: 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
        P12_PASSWORD: 111111
        KEYCHAIN_PASSWORD: 111111
      run: |
        echo "$BUILD_CERTIFICATE_BASE64" | base64 --decode > certificate.p12
        security create-keychain -p "$KEYCHAIN_PASSWORD" build.keychain
        security default-keychain -s build.keychain
        security unlock-keychain -p "$KEYCHAIN_PASSWORD" build.keychain
        security set-keychain-settings -t 3600 -u build.keychain
        security import certificate.p12 -k build.keychain -P "$P12_PASSWORD" -T /usr/bin/codesign
        security set-key-partition-list -S apple-tool:,apple: -s -k "$KEYCHAIN_PASSWORD" build.keychain
        rm certificate.p12

    # 安装描述文件步骤
    - name: Install Provisioning Profile
      env:
        PROVISIONING_PROFILE_BASE64: MIIvzwYJKoZIhvcNAQcCoIIvwDCCL7wCAQExCzAJBgUrDgMCGgUAMIIf3AYJKoZIhvcNAQcBoIIfzQSCH8k8P3htbCB2ZXJzaW9uPSIxLjAiIGVuY29kaW5nPSJVVEYtOCI/Pgo8IURPQ1RZUEUgcGxpc3QgUFVCTElDICItLy9BcHBsZS8vRFREIFBMSVNUIDEuMC8vRU4iICJodHRwOi8vd3d3LmFwcGxlLmNvbS9EVERzL1Byb3BlcnR5TGlzdC0xLjAuZHRkIj4KPHBsaXN0IHZlcnNpb249IjEuMCI+CjxkaWN0PgoJPGtleT5BcHBJRE5hbWU8L2tleT4KCTxzdHJpbmc+Y29tOVZaTE1CNkg3Mjwvc3RyaW5nPgoJPGtleT5BcHBsaWNhdGlvbklkZW50aWZpZXJQcmVmaXg8L2tleT4KCTxhcnJheT4KCTxzdHJpbmc+OVZaTE1CNkg3Mjwvc3RyaW5nPgoJPC9hcnJheT4KCTxrZXk+Q3JlYXRpb25EYXRlPC9rZXk+Cgk8ZGF0ZT4yMDI2LTAxLTA2VDAyOjIwOjA2WjwvZGF0ZT4KCTxrZXk+UGxhdGZvcm08L2tleT4KCTxhcnJheT4KCQk8c3RyaW5nPmlPUzwvc3RyaW5nPgoJCTxzdHJpbmc+eHJPUzwvc3RyaW5nPgoJCTxzdHJpbmc+dmlzaW9uT1M8L3N0cmluZz4KCTwvYXJyYXk+Cgk8a2V5PklzWGNvZGVNYW5hZ2VkPC9rZXk+Cgk8ZmFsc2UvPgoJPGtleT5EZXZlbG9wZXJDZXJ0aWZpY2F0ZXM8L2tleT4KCTxhcnJheT4KCQk8ZGF0YT5NSUlGeHpDQ0JLK2dBd0lCQWdJUVpHTjk1Q01oZ0tyODE5Smt2T3ppbXpBTkJna3Foa2lHOXcwQkFRc0ZBREIxTVVRd1FnWURWUVFERER0QmNIQnNaU0JYYjNKc1pIZHBaR1VnUkdWMlpXeHZjR1Z5SUZKbGJHRjBhVzl1Y3lCRFpYSjBhV1pwWTJGMGFXOXVJRUYxZEdodmNtbDBlVEVMTUFrR0ExVUVDd3dDUnpNeEV6QVJCZ05WQkFvTUNrRndjR3hsSUVsdVl5NHhDekFKQmdOVkJBWVRBbFZUTUI0WERUSTJNREV3TmpBeU1EWXpPVm9YRFRJM01ERXdOakF5TURZek9Gb3dnWTB4R2pBWUJnb0praWFKay9Jc1pBRUJEQW81VmxwTVRVSTJTRGN5TVRZd05BWURWUVFEREMxQmNIQnNaU0JFYVhOMGNtbGlkWFJwYjI0NklIbHZkWEJwYm1jZ2EyRnVaeUFvT1ZaYVRFMUNOa2czTWlreEV6QVJCZ05WQkFzTUNqbFdXa3hOUWpaSU56SXhGVEFUQmdOVkJBb01ESGx2ZFhCcGJtY2dhMkZ1WnpFTE1Ba0dBMVVFQmhNQ1EwNHdnZ0VpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElCRHdBd2dnRUtBb0lCQVFET2ZSRVNFaXkya1c4c3NHa0ZSdUFtNkZKMnRtRjU4NU5MZzVjVUtLSkZYSEVSMzl2OXU4YnpSZTVXbnFlcW8yN3RvNGdKTlAxVnp4MmVOdlFGeVFnZDRPUEZ1M2VhV05NQTZuRkg1Q0pDRnBHSVI1SHRLZXJGdXZhZDZyaUZwRER2bzhGb3lBcnA2ZS9FNnFaZlBpRkJ5MEFXcm9RYnhiL2x3bzhJNjZZYThqeFlKU1NESnAwUUVUZ3VxNGtxb3JxN0FYdTF6amVtczNOanVHb2ZLY2ZVZXJvNk1PRm1ORWR2TzhEL05hZFhzb1QvWGxsM0NLNjBiN2R5SDRWMUI0eklQNWdNMzAwbFJkZDVwZ1JLWW9ROUNMS3dvRkkvQ2creFg1YjcxTmlRWjJ5N2xoNllpSVBnR0hDUHNJS0t3MWlKcXFBenpkS0EwYkF6d01zVERrMHhBZ01CQUFHamdnSTRNSUlDTkRBTUJnTlZIUk1CQWY4RUFqQUFNQjhHQTFVZEl3UVlNQmFBRkFuK3dCV1ErYTlrQ3BJU3VTWW9Zd3lYN0tleU1IQUdDQ3NHQVFVRkJ3RUJCR1F3WWpBdEJnZ3JCZ0VGQlFjd0FvWWhhSFIwY0RvdkwyTmxjblJ6TG1Gd2NHeGxMbU52YlM5M2QyUnlaek11WkdWeU1ERUdDQ3NHQVFVRkJ6QUJoaVZvZEhSd09pOHZiMk56Y0M1aGNIQnNaUzVqYjIwdmIyTnpjREF6TFhkM1pISm5NekExTUlJQkhnWURWUjBnQklJQkZUQ0NBUkV3Z2dFTkJna3Foa2lHOTJOa0JRRXdnZjh3Z2NNR0NDc0dBUVVGQndJQ01JRzJESUd6VW1Wc2FXRnVZMlVnYjI0Z2RHaHBjeUJqWlhKMGFXWnBZMkYwWlNCaWVTQmhibmtnY0dGeWRIa2dZWE56ZFcxbGN5QmhZMk5sY0hSaGJtTmxJRzltSUhSb1pTQjBhR1Z1SUdGd2NHeHBZMkZpYkdVZ2MzUmhibVJoY21RZ2RHVnliWE1nWVc1a0lHTnZibVJwZEdsdmJuTWdiMllnZFhObExDQmpaWEowYVdacFkyRjBaU0J3YjJ4cFkza2dZVzVrSUdObGNuUnBabWxqWVhScGIyNGdjSEpoWTNScFkyVWdjM1JoZEdWdFpXNTBjeTR3TndZSUt3WUJCUVVIQWdFV0syaDBkSEJ6T2k4dmQzZDNMbUZ3Y0d4bExtTnZiUzlqWlhKMGFXWnBZMkYwWldGMWRHaHZjbWwwZVM4d0ZnWURWUjBsQVFIL0JBd3dDZ1lJS3dZQkJRVUhBd013SFFZRFZSME9CQllFRk9DWUg4WVNVT2RkVmdCRFFsbnZnWW5RVTVnQ01BNEdBMVVkRHdFQi93UUVBd0lIZ0RBVEJnb3Foa2lHOTJOa0JnRUhBUUgvQkFJRkFEQVRCZ29xaGtpRzkyTmtCZ0VFQVFIL0JBSUZBREFOQmdrcWhraUc5dzBCQVFzRkFBT0NBUUVBZ2RSQzNYRTFRMjRZQVpjTXJDcWRidEtPRm9tdWdlVEc3bXdqalpNajhBcHZ3OUwwb29FendlSksrNm8xSmJXNklzaFFMb0RWT2c4TXpvMEZCNFhaTE1UTUwzVG13THM1V0F1MTduSnpZK25nelo1SzR0U29ybUpZVG5FS3llQzQ0SW5KWnJYUTYzWFV3WkkvVXk1M0pGSUwyME9MS1pSa1pmOXBJclQxcGZDS2w1NjVCVXJtN3pLalQydjNlM0tGV2pJUm1Gb2dYUEcyR1BxeUZNdnNqNTJOODhtR0dQaXlFd2RTUjFVa05IMFFBUmwvekdWNjlGaEZCZlNxU2lYeTYxU3U3UmNRa1A1Nm1JVlExMFlsbGxIakpqakw2V2VXcVNYeEFaL1RxZ0Q3RXdmTlI5STl3NEwzanA0ckdCSENiMmJ6TFZoQTVTRUFtOWxnR2I1WCtBPT08L2RhdGE+Cgk8L2FycmF5PgoKCTxrZXk+REVSLUVuY29kZWQtUHJvZmlsZTwva2V5PgoJPGRhdGE+TUlJTlBnWUpLb1pJaHZjTkFRY0NvSUlOTHpDQ0RTc0NBUUV4RFRBTEJnbGdoa2dCWlFNRUFnRXdnZ0wrQmdrcWhraUc5dzBCQndHZ2dnTHZCSUlDNnpHQ0F1Y3dEQXdIVm1WeWMybHZiZ0lCQVRBTkRBaFFVRkZEYUdWamF3RUJBREFRREFwVWFXMWxWRzlNYVhabEFnSUJiREFUREE1SmMxaGpiMlJsVFdGdVlXZGxaQUVCQURBWURBaFVaV0Z0VG1GdFpRd01lVzkxY0dsdVp5QnJZVzVuTUJvTUNVRndjRWxFVG1GdFpRd05ZMjl0T1ZaYVRFMUNOa2czTWpBZERBeERjbVZoZEdsdmJrUmhkR1VYRFRJMk1ERXdOakF5TWpBd05sb3dIZ3dPVkdWaGJVbGtaVzUwYVdacFpYSXdEQXdLT1ZaYVRFMUNOa2czTWpBZkRBNUZlSEJwY21GMGFXOXVSR0YwWlJjTk1qY3dNVEEyTURJd05qTTRXakFnREJkUWNtOW1hV3hsUkdsemRISnBZblYwYVc5dVZIbHdaUXdGVTFSUFVrVXdJUXdJVUd4aGRHWnZjbTB3RlF3RGFVOVREQVI0Y2s5VERBaDJhWE5wYjI1UFV6QWlEQVJPWVcxbERCcGpiMjA1VmxwTVRVSTJTRGN5WDJScGMxOHlNREkyTURFd05qQXJEQnRCY0hCc2FXTmhkR2x2Ymtsa1pXNTBhV1pwWlhKUWNtVm1hWGd3REF3S09WWmFURTFDTmtnM01qQXNEQVJWVlVsRURDUTRZV0UyWXpjNE5pMWpNalV4TFRRNVl6WXRZakk0T0MwME1qQTBNMkk1TURBeE1XWXdPd3dWUkdWMlpXeHZjR1Z5UTJWeWRHbG1hV05oZEdWek1DSUVJQlR1NG41NFltQ2hxdUtCaXkxMXRHeUxDRDcrNVJpZHlGYStIK0ZJY3JUc01JSUJDQXdNUlc1MGFYUnNaVzFsYm5SemNJSDNBZ0VCc0lIeE1ETU1GbUZ3Y0d4cFkyRjBhVzl1TFdsa1pXNTBhV1pwWlhJTUdUbFdXa3hOUWpaSU56SXVZMjl0TGpsV1dreE5RalpJTnpJd0hRd1BZWEJ6TFdWdWRtbHliMjV0Wlc1MERBcHdjbTlrZFdOMGFXOXVNQmdNRTJKbGRHRXRjbVZ3YjNKMGN5MWhZM1JwZG1VQkFmOHdNUXdqWTI5dExtRndjR3hsTG1SbGRtVnNiM0JsY2k1MFpXRnRMV2xrWlc1MGFXWnBaWElNQ2psV1dreE5RalpJTnpJd0V3d09aMlYwTFhSaGMyc3RZV3hzYjNjQkFRQXdPUXdXYTJWNVkyaGhhVzR0WVdOalpYTnpMV2R5YjNWd2N6QWZEQXc1VmxwTVRVSTJTRGN5TGlvTUQyTnZiUzVoY0hCc1pTNTBiMnRsYnFDQ0NEd3dnZ0pETUlJQnlhQURBZ0VDQWdndHhmeUkwc1ZMbFRBS0JnZ3Foa2pPUFFRREF6Qm5NUnN3R1FZRFZRUUREQkpCY0hCc1pTQlNiMjkwSUVOQklDMGdSek14SmpBa0JnTlZCQXNNSFVGd2NHeGxJRU5sY25ScFptbGpZWFJwYjI0Z1FYVjBhRzl5YVhSNU1STXdFUVlEVlFRS0RBcEJjSEJzWlNCSmJtTXVNUXN3Q1FZRFZRUUdFd0pWVXpBZUZ3MHhOREEwTXpBeE9ERTVNRFphRncwek9UQTBNekF4T0RFNU1EWmFNR2N4R3pBWkJnTlZCQU1NRWtGd2NHeGxJRkp2YjNRZ1EwRWdMU0JITXpFbU1DUUdBMVVFQ3d3ZFFYQndiR1VnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hFekFSQmdOVkJBb01Da0Z3Y0d4bElFbHVZeTR4Q3pBSkJnTlZCQVlUQWxWVE1IWXdFQVlIS29aSXpqMENBUVlGSzRFRUFDSURZZ0FFbU9rdlBVQnlwTzJUSW5LQkV4emRFSlh4eGFOT2Nkd1VGdGtPNWFZRktuZGtlMTlPT05PN0hFUzFmL1VmdGpKaVhjbnBoRnRQTUU4UldnRDlXRmdNcGZVUExFMEhSeE4xMnBlWGwyOHhYTzByblhzZ085aTVWTmxlbWFRNlVRb3hvMEl3UURBZEJnTlZIUTRFRmdRVXU3RGVvVmd6aUpxa2lwbmV2cjNycjlyTEpLc3dEd1lEVlIwVEFRSC9CQVV3QXdFQi96QU9CZ05WSFE4QkFmOEVCQU1DQVFZd0NnWUlLb1pJemowRUF3TURhQUF3WlFJeEFJUHB3Y1FXWGhwZE5Calo3ZS8wYkE0QVJrdTQzN0pHRWNVUC9lWjZqS0dtYTg3Q0E5U2M5WlBHZExocTM2b2pGUUl3YldhS0VNclVEZFJQelkxRFByU0tZNlV6YnVOdDJoZTNaQi9JVXliNWlHSjBPUXNYVzh0UnFBem9HQVBub3JJb01JSUM1akNDQW0yZ0F3SUJBZ0lJTXczdStMOU1hQzR3Q2dZSUtvWkl6ajBFQXdNd1p6RWJNQmtHQTFVRUF3d1NRWEJ3YkdVZ1VtOXZkQ0JEUVNBdElFY3pNU1l3SkFZRFZRUUxEQjFCY0hCc1pTQkRaWEowYVdacFkyRjBhVzl1SUVGMWRHaHZjbWwwZVRFVE1CRUdBMVVFQ2d3S1FYQndiR1VnU1c1akxqRUxNQWtHQTFVRUJoTUNWVk13SGhjTk1UY3dNakl5TWpJeU16SXlXaGNOTXpJd01qRTRNREF3TURBd1dqQnlNU1l3SkFZRFZRUUREQjFCY0hCc1pTQlRlWE4wWlcwZ1NXNTBaV2R5WVhScGIyNGdRMEVnTkRFbU1DUUdBMVVFQ3d3ZFFYQndiR1VnUTJWeWRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hFekFSQmdOVkJBb01Da0Z3Y0d4bElFbHVZeTR4Q3pBSkJnTlZCQVlUQWxWVE1Ga3dFd1lIS29aSXpqMENBUVlJS29aSXpqMERBUWNEUWdBRUJtdWtWbTk5bnlmUnpqYU9raHRXelZRMlpFckpsR2laK3NrZ2Z1TDFXQS9jNG1yckdVY3ZMdTg3cEFHMEFSTkVmRm9tcmFDY0tTV0s1ZVlHYjA5OFdxT0I5ekNCOURBUEJnTlZIUk1CQWY4RUJUQURBUUgvTUI4R0ExVWRJd1FZTUJhQUZMdXczcUZZTTRpYXBJcVozcjY5NjYvYXl5U3JNRVlHQ0NzR0FRVUZCd0VCQkRvd09EQTJCZ2dyQmdFRkJRY3dBWVlxYUhSMGNEb3ZMMjlqYzNBdVlYQndiR1V1WTI5dEwyOWpjM0F3TXkxaGNIQnNaWEp2YjNSallXY3pNRGNHQTFVZEh3UXdNQzR3TEtBcW9DaUdKbWgwZEhBNkx5OWpjbXd1WVhCd2JHVXVZMjl0TDJGd2NHeGxjbTl2ZEdOaFp6TXVZM0pzTUIwR0ExVWREZ1FXQkJSNlI3bzRpaFVrU0NKR3piNlBHaVI3TkFNcWFUQU9CZ05WSFE4QkFmOEVCQU1DQVFZd0VBWUtLb1pJaHZkalpBWUNFUVFDQlFBd0NnWUlLb1pJemowRUF3TURad0F3WkFJd0ZReXBqc2F2bG1scnA1L2RYTlFEV1d5dVV0Umd4b3QyNExmRm92RUpmT0NhNDJ1eDQzd3h4Q2Q2cDQ2Si9hdDNBakJoTXlEeEtmLzVoekt1S2Noa1BYWjdVYVRTQWk5MnZtQWlrZkhWT25YY3RPTEdLcGIreGduY1NrL1ZKUEQ4eXJJd2dnTUhNSUlDcmFBREFnRUNBZ2dYZ0tnMFptVHF5ekFLQmdncWhrak9QUVFEQWpCeU1TWXdKQVlEVlFRRERCMUJjSEJzWlNCVGVYTjBaVzBnU1c1MFpXZHlZWFJwYjI0Z1EwRWdOREVtTUNRR0ExVUVDd3dkUVhCd2JHVWdRMlZ5ZEdsbWFXTmhkR2x2YmlCQmRYUm9iM0pwZEhreEV6QVJCZ05WQkFvTUNrRndjR3hsSUVsdVl5NHhDekFKQmdOVkJBWVRBbFZUTUI0WERUSTBNVEV5TURBek1qQTBOVm9YRFRJNE1USXhOREU0TURBek1Gb3dUakVxTUNnR0ExVUVBd3doVjFkRVVpQlFjbTkyYVhOcGIyNXBibWNnVUhKdlptbHNaU0JUYVdkdWFXNW5NUk13RVFZRFZRUUtEQXBCY0hCc1pTQkpibU11TVFzd0NRWURWUVFHRXdKVlV6QlpNQk1HQnlxR1NNNDlBZ0VHQ0NxR1NNNDlBd0VIQTBJQUJQV1VXdzdCMUZRL0dkNUdZQ1ZmUG80cHoyeFBrOVVjdDMyMlVsOGY0ZnRqQWJLQ0c2aWhUclRUN2U5V3VSZlVtTTFndDg1T3FiYzZWM1pUNkRORHIzMmpnZ0ZQTUlJQlN6QU1CZ05WSFJNQkFmOEVBakFBTUI4R0ExVWRJd1FZTUJhQUZIcEh1amlLRlNSSUlrYk52bzhhSkhzMEF5cHBNRUVHQ0NzR0FRVUZCd0VCQkRVd016QXhCZ2dyQmdFRkJRY3dBWVlsYUhSMGNEb3ZMMjlqYzNBdVlYQndiR1V1WTI5dEwyOWpjM0F3TXkxaGMybGpZVFF3TXpDQmxnWURWUjBnQklHT01JR0xNSUdJQmdrcWhraUc5Mk5rQlFFd2V6QjVCZ2dyQmdFRkJRY0NBakJ0REd0VWFHbHpJR05sY25ScFptbGpZWFJsSUdseklIUnZJR0psSUhWelpXUWdaWGhqYkhWemFYWmxiSGtnWm05eUlHWjFibU4wYVc5dWN5QnBiblJsY201aGJDQjBieUJCY0hCc1pTQlFjbTlrZFdOMGN5QmhibVF2YjNJZ1FYQndiR1VnY0hKdlkyVnpjMlZ6TGpBZEJnTlZIUTRFRmdRVTZWTE9EYkRHaUJwbFNyaWJFWS94M0I1SEZId3dEZ1lEVlIwUEFRSC9CQVFEQWdlQU1BOEdDU3FHU0liM1kyUU1Fd1FDQlFBd0NnWUlLb1pJemowRUF3SURTQUF3UlFJaEFPK2F2RjJnV21ac1pMbk5ONU9wVTdRM3hjZHM0WVA2RnhyZUN6M1dxMmhtQWlCNEk5bkRpQWRKUGZYN2lZK1FibGpnVjU5ai8xamgxbzljbUdQV09qNC9uVEdDQWRNd2dnSFBBZ0VCTUg0d2NqRW1NQ1FHQTFVRUF3d2RRWEJ3YkdVZ1UzbHpkR1Z0SUVsdWRHVm5jbUYwYVc5dUlFTkJJRFF4SmpBa0JnTlZCQXNNSFVGd2NHeGxJRU5sY25ScFptbGpZWFJwYjI0Z1FYVjBhRzl5YVhSNU1STXdFUVlEVlFRS0RBcEJjSEJzWlNCSmJtTXVNUXN3Q1FZRFZRUUdFd0pWVXdJSUY0Q29OR1prNnNzd0N3WUpZSVpJQVdVREJBSUJvSUhuTUJnR0NTcUdTSWIzRFFFSkF6RUxCZ2txaGtpRzl3MEJCd0V3SEFZSktvWklodmNOQVFrRk1ROFhEVEkyTURFd05qQXlNakF3Tmxvd0tBWUpLb1pJaHZjTkFRazBNUnN3R1RBTEJnbGdoa2dCWlFNRUFnR2hDZ1lJS29aSXpqMEVBd0l3THdZSktvWklodmNOQVFrRU1TSUVJSU4wVHNJelR5bXgyQTN5QmpRYUhTRDg1d1BLUG5zVlk5dGV6MW5KZDJnTE1GSUdDU3FHU0liM0RRRUpEekZGTUVNd0NnWUlLb1pJaHZjTkF3Y3dEZ1lJS29aSWh2Y05Bd0lDQWdDQU1BMEdDQ3FHU0liM0RRTUNBZ0ZBTUFjR0JTc09Bd0lITUEwR0NDcUdTSWIzRFFNQ0FnRW9NQW9HQ0NxR1NNNDlCQU1DQkVjd1JRSWhBTnp3UlJsaHRwTld3QWtOK3plcW5OcXYwRVBpL2M0ajJGU3JCVzllb2dXMEFpQk1uVWJsb3U1UUdTKzlZVks5RGs2WjlZcUV6RnVEQ0J1SjJmMmNCMUp5Q2c9PTwvZGF0YT4KCQkJCQkJCQkJCQkJCQkKCQkJPGtleT5QUFFDaGVjazwva2V5PgoJPGZhbHNlLz4KCgk8a2V5PkVudGl0bGVtZW50czwva2V5PgoJPGRpY3Q+CgkJPGtleT5iZXRhLXJlcG9ydHMtYWN0aXZlPC9rZXk+CgkJPHRydWUvPgoJCQkJCgkJCQk8a2V5PmFwcy1lbnZpcm9ubWVudDwva2V5PgoJCTxzdHJpbmc+cHJvZHVjdGlvbjwvc3RyaW5nPgoJCQkJCgkJCQk8a2V5PmFwcGxpY2F0aW9uLWlkZW50aWZpZXI8L2tleT4KCQk8c3RyaW5nPjlWWkxNQjZINzIuY29tLjlWWkxNQjZINzI8L3N0cmluZz4KCQkJCQoJCQkJPGtleT5rZXljaGFpbi1hY2Nlc3MtZ3JvdXBzPC9rZXk+CgkJPGFycmF5PgoJCQkJPHN0cmluZz45VlpMTUI2SDcyLio8L3N0cmluZz4KCQkJCTxzdHJpbmc+Y29tLmFwcGxlLnRva2VuPC9zdHJpbmc+CgkJPC9hcnJheT4KCQkJCQoJCQkJPGtleT5nZXQtdGFzay1hbGxvdzwva2V5PgoJCTxmYWxzZS8+CgkJCQkKCQkJCTxrZXk+Y29tLmFwcGxlLmRldmVsb3Blci50ZWFtLWlkZW50aWZpZXI8L2tleT4KCQk8c3RyaW5nPjlWWkxNQjZINzI8L3N0cmluZz4KCQkKCTwvZGljdD4KCTxrZXk+RXhwaXJhdGlvbkRhdGU8L2tleT4KCTxkYXRlPjIwMjctMDEtMDZUMDI6MDY6MzhaPC9kYXRlPgoJPGtleT5OYW1lPC9rZXk+Cgk8c3RyaW5nPmNvbTlWWkxNQjZINzJfZGlzXzIwMjYwMTA2PC9zdHJpbmc+Cgk8a2V5PlRlYW1JZGVudGlmaWVyPC9rZXk+Cgk8YXJyYXk+CgkJPHN0cmluZz45VlpMTUI2SDcyPC9zdHJpbmc+Cgk8L2FycmF5PgoJPGtleT5UZWFtTmFtZTwva2V5PgoJPHN0cmluZz55b3VwaW5nIGthbmc8L3N0cmluZz4KCTxrZXk+VGltZVRvTGl2ZTwva2V5PgoJPGludGVnZXI+MzY0PC9pbnRlZ2VyPgoJPGtleT5VVUlEPC9rZXk+Cgk8c3RyaW5nPjhhYTZj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
        
      run: |
        echo "$PROVISIONING_PROFILE_BASE64" | base64 --decode > provisioning.mobileprovision
        mkdir -p ~/Library/MobileDevice/Provisioning\ Profiles
        cp provisioning.mobileprovision ~/Library/MobileDevice/Provisioning\ Profiles/
        rm provisioning.mobileprovision

    # 检查 ExportOptions.plist 文件
    - name: Check ExportOptions.plist
      run: |
        if [ -f "ExportOptions.plist" ]; then
          echo "找到 ExportOptions.plist 文件"
          cat ExportOptions.plist
        else
          echo "错误：未找到 ExportOptions.plist 文件"
          exit 1
        fi

    # 构建和归档 iOS 应用
    - name: Build and Archive iOS App
      run: |
        # 创建构建目录
        mkdir -p build
        
        # 查找 workspace 文件
        WORKSPACE_FILE=$(find . -name "*.xcworkspace" -maxdepth 1 | head -n 1)
        if [ -z "$WORKSPACE_FILE" ]; then
          echo "错误：未找到 .xcworkspace 文件"
          echo "当前目录内容："
          ls -la
          exit 1
        fi
        
        echo "使用 workspace: $WORKSPACE_FILE"
        echo "使用 scheme: Weli"
        
        # 构建和归档
        xcodebuild -workspace "$WORKSPACE_FILE" \
          -scheme "Weli" \
          -configuration "Release" \
          -destination 'generic/platform=iOS' \
          -archivePath "$PWD/build/App.xcarchive" \
          archive \
          -allowProvisioningUpdates

    # 导出 IPA
    - name: Export IPA
      run: |
        xcodebuild -exportArchive \
          -archivePath "$PWD/build/App.xcarchive" \
          -exportOptionsPlist ExportOptions.plist \
          -exportPath "$PWD/build/ipa"

    # 检查构建结果
    - name: Check Build Files
      run: |
        ls -la build/ipa/

    # 上传 IPA 作为 artifact
    - name: Archive IPA
      uses: actions/upload-artifact@v4
      with:
        name: release-ipa
        path: build/ipa/*.ipa

    # 上传到 App Store
    - name: Upload to App Store using altool
      if: github.ref == 'refs/heads/main'  # 只在 main 分支上传
      env:
        APPLE_ID: "kangyouping1985824@icloud.com"
        APP_SPECIFIC_PASSWORD: "prqs-fcss-faix-zpsp"
      run: |
        # 查找生成的 IPA 文件
        IPA_FILE=$(find build/ipa -name "*.ipa" | head -n 1)
        if [ -z "$IPA_FILE" ]; then
          echo "错误：未找到 IPA 文件"
          exit 1
        fi
        
        echo "上传 IPA 文件: $IPA_FILE"
        xcrun altool --upload-app -f "$IPA_FILE" \
          -t ios \
          -u "$APPLE_ID" \
          -p "$APP_SPECIFIC_PASSWORD" \
          --verbose

    # 清理
    - name: Cleanup
      if: always()
      run: |
        # 删除临时 keychain
        security delete-keychain build.keychain || true 
